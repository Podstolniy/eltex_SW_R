# -*- coding: utf-8 -*-
#my_unicode_string = u"This's Unicode!"
#!/usr/bin/python

#запуск с командой sh ip status
#пример: python authorization.py "sh ip status"

import os
import platform
import csv
import subprocess
import sys
#*************
#for ssh
import pexpect  #установка библиотеки через pip3
import	getpass
#*************
import argparse
import json
import math
import abc
from collections import Counter
from pexpect.popen_spawn import PopenSpawn 
COMMAND	=	sys.argv[1]
USER	=	input('Username:')
PASSWORD	=	getpass.getpass()
ENABLE_PASS	=	getpass.getpass(prompt='Enter enable password:')
DEVICES_IP	=	['192.168.22.10']

for	IP	in	DEVICES_IP:
	print('Connection	to	device	{}'.format(IP))
	with pexpect.spawn('ssh	{}@{}'.format(USER,	IP)) as ssh:
	
		ssh.expect('Password:')
		ssh.sendline(PASSWORD)
		ssh.expect('[#>]')
		ssh.sendline('enable')
		ssh.expect('Password:')
		ssh.sendline(ENABLE_PASS)
		#ssh.expect('#')
		#ssh.sendline('terminal	length	0')
		ssh.expect('#')
		ssh.sendline(COMMAND)
		ssh.expect('#')
		print(ssh.before.decode('utf-8'))
